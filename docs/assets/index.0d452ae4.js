import{r as i,j as g,E as m,O as f,e as h,R as b,a as y}from"./vendor.c2f1a328.js";const x=function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))r(e);new MutationObserver(e=>{for(const n of e)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function s(e){const n={};return e.integrity&&(n.integrity=e.integrity),e.referrerpolicy&&(n.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?n.credentials="include":e.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(e){if(e.ep)return;e.ep=!0;const n=s(e);fetch(e.href,n)}};x();const S=(t,o)=>{if(o.kind==="setConnectionState")return o.payload.state;if(t.kind!=="connected")return t;const s=t.obsState;switch(o.kind){case"setMicVolume":s.micVolume=o.payload.micVolume}return t},p=(t,o)=>{const[s,r]=i.exports.useState(""),e=n=>{localStorage.setItem(t,n),r(n)};return i.exports.useEffect(()=>{const n=localStorage.getItem(t);n===null?e(o):r(n)},[t]),[s,e]},c=g.exports.jsx,u=g.exports.jsxs,v=({errorMessage:t,obs:o,dispatch:s})=>{const[r,e]=p("address","ws://localhost:4455"),[n,a]=p("password","");return u("div",{children:[t&&c("span",{className:"block text-sm font-medium text-red-700",children:t}),u("label",{children:[c("span",{className:"block my-2 text-sm font-medium text-slate-700  mr-1",children:"Address"}),c("input",{className:"peer p-1 border-2 rounded-lg mr-2",value:r,onChange:l=>e(l.target.value)})]}),u("label",{children:[c("span",{className:"block my-2 text-sm font-medium text-slate-700 mr-1",children:"Password"}),c("input",{type:"password",className:"peer p-1 border-2 rounded-lg mr-2",value:n,onChange:l=>a(l.target.value)})]}),c("button",{className:"block my-4 px-4 py-1 rounded-lg text-white bg-blue-600 hover:bg-blue-700",onClick:async()=>{try{await o.current.connect(r,n,{eventSubscriptions:m.All|m.InputVolumeMeters,rpcVersion:1}),console.info("connected to OBS")}catch(l){console.error(l),s({kind:"setConnectionState",payload:{state:{kind:"loggingIn",errorMessage:`Logging in failed: ${l.message}`}}});return}s({kind:"setConnectionState",payload:{state:{kind:"connected",obsState:{micVolume:0}}}})},children:"Connect"})]})};var C="/assets/pngtuber-eyes-open-mouth-closed.6696aaad.png",k="/assets/pngtuber-eyes-open-mouth-open.4f86b780.png",M="/assets/pngtuber-eyes-closed-mouth-closed.1b87bb29.png",O="/assets/pngtuber-eyes-closed-mouth-open.3181fc6a.png";const w=({state:{micVolume:t}})=>{const[o,s]=i.exports.useState(Array.from({length:5}).map(()=>-1/0));i.exports.useEffect(()=>{s([...o.slice(1),t])},[t]);const r=Math.sin(Date.now()/1e3)>-.995,e=Math.max(...o)>-30;return c("div",{children:c("img",{className:`${e?"animate-talking":"animate-breathing"}`,src:e?r?k:O:r?C:M})})},E=(t,o)=>{const s=t.find(o);if(!s)throw Error("failed to find item in mustFind");return s},V=t=>20*Math.log10(t);function L(){const t=i.exports.useRef(new f),[o,s]=h(S,{kind:"loggingIn"});return i.exports.useEffect(()=>{t.current.on,t.current.on("InputVolumeMeters",({inputs:r})=>{const n=E(r,({inputName:d})=>d.toLowerCase()==="mic").inputLevelsMul[0][2],a=V(n);s({kind:"setMicVolume",payload:{micVolume:a}})})},[]),c("div",{className:"p-5",children:o.kind==="connected"?c(w,{state:o.obsState}):c(v,{errorMessage:o.errorMessage,obs:t,dispatch:s})})}b.render(c(y.StrictMode,{children:c(L,{})}),document.getElementById("root"));
